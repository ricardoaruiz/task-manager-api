# üìã API Task Manager

Uma API REST completa para gerenciamento de tarefas, desenvolvida com **Node.js**, **TypeScript** e **Fastify**.

## üöÄ Tecnologias Utilizadas

### **Backend Framework & Runtime**
- **Node.js** - Runtime JavaScript
- **TypeScript** - Superset tipado do JavaScript
- **Fastify** - Framework web r√°pido e eficiente
- **fastify-type-provider-zod** - Integra√ß√£o do Zod com Fastify para valida√ß√£o de tipos

### **Banco de Dados & ORM**
- **SQLite3** - Banco de dados relacional leve (desenvolvimento)
- **Knex.js** - Query builder SQL para Node.js
- **PostgreSQL** - Suporte para banco em produ√ß√£o

### **Valida√ß√£o & Schemas**
- **Zod** - Valida√ß√£o de schemas TypeScript-first
- **dotenv** - Gerenciamento de vari√°veis de ambiente

### **Desenvolvimento & Qualidade de C√≥digo**
- **TSX** - Execu√ß√£o de TypeScript no desenvolvimento
- **TSUP** - Bundler TypeScript super r√°pido
- **Biome** - Linter e formatter moderno
- **Ultracite** - Configura√ß√£o de linting otimizada
- **Vitest** - Framework de testes unit√°rios
- **Supertest** - Biblioteca para testes HTTP

### **Git Hooks & Commits**
- **Husky** - Git hooks
- **Commitizen** - Padroniza√ß√£o de commits
- **Commitlint** - Valida√ß√£o de mensagens de commit
- **lint-staged** - Executa linters em arquivos staged

## üìÅ Estrutura do Projeto

```
src/
‚îú‚îÄ‚îÄ app.ts                    # Configura√ß√£o principal do Fastify
‚îú‚îÄ‚îÄ server.ts                 # Inicializa√ß√£o do servidor
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ db.ts                 # Configura√ß√£o do Knex
‚îÇ   ‚îî‚îÄ‚îÄ migrations/           # Migra√ß√µes do banco de dados
‚îú‚îÄ‚îÄ env-variables/            # Valida√ß√£o de vari√°veis de ambiente
‚îÇ   ‚îú‚îÄ‚îÄ env-variables.ts
‚îÇ   ‚îú‚îÄ‚îÄ env-variables.schema.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îî‚îÄ‚îÄ global-error-handler.ts  # Tratamento global de erros
‚îî‚îÄ‚îÄ routes/
    ‚îú‚îÄ‚îÄ health/               # Endpoints de health check
    ‚îî‚îÄ‚îÄ tasks/                # Endpoints de gerenciamento de tarefas
        ‚îú‚îÄ‚îÄ create-task.ts
        ‚îú‚îÄ‚îÄ list-tasks.ts
        ‚îú‚îÄ‚îÄ get-task.ts
        ‚îú‚îÄ‚îÄ update-task.ts
        ‚îú‚îÄ‚îÄ complete-task.ts
        ‚îî‚îÄ‚îÄ delete-task.ts
```

## üõ†Ô∏è Configura√ß√£o do Ambiente

### **Pr√©-requisitos**
- Node.js >= 18.x
- npm ou yarn

### **Vari√°veis de Ambiente**
Crie um arquivo `.env` na raiz do projeto:

```env
PORT=3333
DATABASE_CLIENT=sqlite3
DATABASE_URL=./database/dev.sqlite3
```

Para produ√ß√£o com PostgreSQL:
```env
PORT=3333
DATABASE_CLIENT=pg
DATABASE_URL=postgresql://username:password@localhost:5432/taskmanager
```

## üì¶ Instala√ß√£o

```bash
# Clone o reposit√≥rio
git clone <url-do-repositorio>
cd 02-api-task-manager

# Instale as depend√™ncias
npm install

# Execute as migra√ß√µes do banco de dados
npm run migrate:latest

# Inicie o servidor em modo de desenvolvimento
npm run dev
```

## üéØ Comandos Dispon√≠veis

### **Desenvolvimento**
```bash
npm run dev          # Inicia o servidor em modo watch
npm run build        # Compila o projeto para produ√ß√£o
npm run start        # Executa a vers√£o compilada
```

### **Banco de Dados**
```bash
npm run migrate:make <nome>    # Cria uma nova migra√ß√£o
npm run migrate:latest         # Executa migra√ß√µes pendentes
npm run knex                   # Acesso direto ao CLI do Knex
```

### **Qualidade de C√≥digo**
```bash
npm run lint         # Verifica problemas no c√≥digo
npm run lint:fix     # Corrige problemas automaticamente
npm run lint:doctor  # Diagn√≥stico detalhado do linting
```

### **Testes**
```bash
npm test            # Executa todos os testes
npm run test:watch  # Executa testes em modo watch
```

## üåê API Endpoints

### **Health Check**
- `GET /health` - Verifica se a API est√° funcionando

### **Gerenciamento de Tarefas**

#### **Listar Tarefas**
```http
GET /tasks
```

#### **Obter Tarefa Espec√≠fica**
```http
GET /tasks/:id
```

#### **Criar Nova Tarefa**
```http
POST /tasks
Content-Type: application/json

{
  "title": "T√≠tulo da tarefa",
  "description": "Descri√ß√£o detalhada da tarefa"
}
```

#### **Atualizar Tarefa**
```http
PUT /tasks/:id
Content-Type: application/json

{
  "title": "Novo t√≠tulo",
  "description": "Nova descri√ß√£o"
}
```

#### **Marcar Tarefa como Conclu√≠da**
```http
PATCH /tasks/:id/complete
```

#### **Deletar Tarefa**
```http
DELETE /tasks/:id
```

## üóÑÔ∏è Estrutura do Banco de Dados

### **Tabela: tasks**
| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `id` | UUID | Identificador √∫nico (Primary Key) |
| `title` | STRING | T√≠tulo da tarefa (obrigat√≥rio) |
| `description` | TEXT | Descri√ß√£o detalhada (obrigat√≥rio) |
| `completed` | BOOLEAN | Status de conclus√£o (padr√£o: false) |
| `created_at` | TIMESTAMP | Data de cria√ß√£o |
| `updated_at` | TIMESTAMP | Data da √∫ltima atualiza√ß√£o |

## üîß Como Funciona o C√≥digo

### **Arquitetura da Aplica√ß√£o**

1. **`server.ts`** - Ponto de entrada que inicializa o servidor Fastify na porta configurada
2. **`app.ts`** - Configura√ß√£o central do Fastify com:
   - Valida√ß√£o autom√°tica de schemas com Zod
   - Tratamento global de erros
   - Registro de rotas modulares

### **Valida√ß√£o de Dados**
- Todas as requisi√ß√µes s√£o validadas usando **Zod schemas**
- O `fastify-type-provider-zod` garante type safety entre runtime e compile time
- Valida√ß√£o autom√°tica de par√¢metros, body e query strings

### **Gerenciamento de Banco de Dados**
- **Knex.js** como query builder abstrai diferentes SGBDs
- Migra√ß√µes versionam mudan√ßas no schema
- Suporte nativo para SQLite (dev) e PostgreSQL (produ√ß√£o)

### **Tratamento de Erros**
- Middleware global captura e formata erros consistentemente
- C√≥digos HTTP apropriados usando `http-status-codes`
- Respostas de erro padronizadas

### **Vari√°veis de Ambiente**
- Valida√ß√£o rigorosa usando Zod schemas
- Falha r√°pida se configura√ß√µes estiverem inv√°lidas
- Suporte a diferentes ambientes (dev, test, prod)

## üß™ Testes

O projeto usa **Vitest** para testes unit√°rios e de integra√ß√£o:

```bash
# Executar todos os testes
npm test

# Testes em modo watch
npm run test:watch

# Testes com cobertura
npm run test:coverage
```

Os testes incluem:
- Valida√ß√£o de endpoints HTTP
- Testes de integra√ß√£o com banco de dados
- Valida√ß√£o de schemas e middlewares

## üìã Padr√µes de C√≥digo

### **Commits Convencionais**
O projeto usa Commitizen para padronizar commits:

```bash
npm run commit
```

Tipos de commit suportados:
- `feat`: Nova funcionalidade
- `fix`: Corre√ß√£o de bug
- `docs`: Documenta√ß√£o
- `style`: Formata√ß√£o
- `refactor`: Refatora√ß√£o
- `test`: Testes
- `chore`: Tarefas de manuten√ß√£o

### **Linting e Formatting**
- **Biome** para linting e formatting
- **Ultracite** para configura√ß√µes otimizadas
- Execu√ß√£o autom√°tica em pre-commit hooks

## üöÄ Deploy

### **Build para Produ√ß√£o**
```bash
npm run build
npm start
```

### **Vari√°veis de Ambiente - Produ√ß√£o**
```env
PORT=3333
DATABASE_CLIENT=pg
DATABASE_URL=postgresql://user:password@host:port/database
```

## ü§ù Contribuindo

1. Fa√ßa fork do projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudan√ßas usando Commitizen (`npm run commit`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa ISC.

---

**Desenvolvido com ‚ù§Ô∏è por Ricardo Ruiz - Dev Fullstack**